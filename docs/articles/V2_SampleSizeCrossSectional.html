<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Estimating the sample size needed for variant monitoring • phylosamp</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Estimating the sample size needed for variant monitoring">
<meta property="og:description" content="phylosamp">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-173221313-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-173221313-2');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">phylosamp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Transmission Linkage</li>
    <li>
      <a href="../articles/L1_FalseDiscoveryRate.html">Estimating the linkage false discovery rate</a>
    </li>
    <li>
      <a href="../articles/L2_SampleSize.html">Sample size calculations for transmission linkage</a>
    </li>
    <li>
      <a href="../articles/L3_SensitivitySpecificity.html">Estimating sensitivity and specificity of a linkage criteria</a>
    </li>
    <li>
      <a href="../articles/L4_IllustrativeExamples.html">Illustrative Examples</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Variant Tracking</li>
    <li>
      <a href="../articles/V1_CoefficientDetectionBias.html">Estimating bias in observed variant prevalence</a>
    </li>
    <li>
      <a href="../articles/V2_SampleSizeCrossSectional.html">Sample size calculations for variant tracking (cross-sectional sampling)</a>
    </li>
    <li>
      <a href="../articles/V3_ProbCrossSectional.html">Probability of detection and prevalence estimation (cross-sectional sampling)</a>
    </li>
    <li>
      <a href="../articles/V4_SampleSizePeriodic.html">Sample size calculations for variant tracking (periodic sampling)</a>
    </li>
    <li>
      <a href="../articles/V5_ProbDetectPeriodic.html">Probability of detection (periodic sampling)</a>
    </li>
    <li>
      <a href="../articles/V6_IllustrativeExample.html">Variant Surveillance Example</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/HopkinsIDD/phylosamp/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Estimating the sample size needed for variant
monitoring</h1>
            <h3 data-toc-skip class="subtitle">Cross-sectional
sampling</h3>
            
      
      <small class="dont-index">Source: <a href="https://github.com/HopkinsIDD/phylosamp/blob/HEAD/vignettes/V2_SampleSizeCrossSectional.Rmd" class="external-link"><code>vignettes/V2_SampleSizeCrossSectional.Rmd</code></a></small>
      <div class="hidden name"><code>V2_SampleSizeCrossSectional.Rmd</code></div>

    </div>

    
    
<p>This vignette provides an overview of the functions that can be used
to estimate the sample size needed to detect a pathogen variant or
estimate its frequency in a population, given molecular characterization
of a single cross-sectional sample of pathogen infections.</p>
<div class="section level5">
<h5 id="variant-detection">Variant detection<a class="anchor" aria-label="anchor" href="#variant-detection"></a>
</h5>
<div class="figure">
<img src="variant-surveillance-decision-tree-03.png" style="width:80.0%" alt=""><p class="caption"><strong>Figure 1.</strong> Identifying the key
question (detection vs prevalence monitoring) is the second step in
designing a pathogen surveillance system. Determining the sample size
needed to answer this question then requires determining the sampling
frequency, i.e., if samples will be collected and sequenced just once
(cross-sectional sampling) or with some regularity over a period of time
(periodic surveillance).</p>
</div>
<p><br></p>
<p>When the goal is detecting the presence or absence of a specific
variant in a population using a single cross-sectional sample
(<strong>Figure 1</strong>), we can use the
<code><a href="../reference/vartrack_samplesize_detect.html">vartrack_samplesize_detect()</a></code> function with the
<code>sampling_freq = "xsect"</code> option. Applying this function,
however, requires knowledge of the coefficient of detection ratio
between two pathogen variants (or, more commonly, one variant and the
rest of the pathogen population). The coefficient of detection ratio for
two variants can be calculated using the
<code><a href="../reference/vartrack_cod_ratio.html">vartrack_cod_ratio()</a></code> function (see <a href="V1_CoefficientDetectionBias.html"><em>Estimating bias in observed
variant prevalence</em></a> for more details). Since we are only
interested in the ratio of the coefficients of detection, applying this
function only requires providing parameters which are expected to differ
between variants. The ratio between any variants not provided is assumed
to be equal to one.</p>
<p>Once we have an estimate of the coefficient of detection ratio, we
can calculate the sample size needed for detection from the following
parameters:</p>
<table class="table">
<colgroup>
<col width="20%">
<col width="42%">
<col width="37%">
</colgroup>
<thead><tr class="header">
<th align="center">Param</th>
<th align="center">Variable Name</th>
<th><span style="display: inline-block; width:500px">Description</span></th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><strong><span class="math inline">\(P_{V_1}\)</span></strong></td>
<td align="center">p_v1</td>
<td>the desired minimum variant prevalence to be able to detect</td>
</tr>
<tr class="even">
<td align="center"><strong><span class="math inline">\(p\)</span></strong></td>
<td align="center">prob</td>
<td>the desired probability of detection</td>
</tr>
<tr class="odd">
<td align="center"><strong><span class="math inline">\(\omega\)</span></strong></td>
<td align="center">omega</td>
<td>the sequencing success rate</td>
</tr>
<tr class="even">
<td align="center"><strong><span class="math inline">\(\frac{C_{V_1}}{C_{V_2}}\)</span></strong></td>
<td align="center">c_ratio</td>
<td>the coefficient of detection ratio, calculated as the ratio of the
coefficients of variant 1 to variant 2 (can be calculated using
<code><a href="../reference/vartrack_cod_ratio.html">vartrack_cod_ratio()</a></code>)</td>
</tr>
</tbody>
</table>
<p>We then apply this sample size calculation function as follows:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/HopkinsIDD/phylosamp" class="external-link">phylosamp</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/vartrack_samplesize_detect.html">vartrack_samplesize_detect</a></span><span class="op">(</span>p_v1<span class="op">=</span><span class="fl">0.02</span>, prob<span class="op">=</span><span class="fl">0.95</span>, omega<span class="op">=</span><span class="fl">0.8</span>, </span>
<span>                           c_ratio<span class="op">=</span><span class="fl">1.368</span>, sampling_freq<span class="op">=</span><span class="st">"xsect"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Calculating sample size for variant detection assuming single cross-sectional sample</span></span></code></pre>
<pre><code><span><span class="co">## [1] 135.9928</span></span></code></pre>
<p>In other words, 136 samples are needed to detect a variant at 2% (or
higher) in a population with 95% of detection, given a coefficient of
detection ratio (<span class="math inline">\(\frac{C_{V_1}}{C_{V_2}}\)</span>) of 1.368 and a
single, cross-sectional sample. This takes into account the fact that
not all samples sequenced (or otherwise characterized) will be
successful. We assume an 80% success rate (<span class="math inline">\(\omega=0.8\)</span>), which ensures a selection of
136 samples will produce the 109 high quality data points that can be
used to detect the presence of a pathogen variant.</p>
</div>
<div class="section level5">
<h5 id="variant-prevalence">Variant prevalence<a class="anchor" aria-label="anchor" href="#variant-prevalence"></a>
</h5>
<div class="figure">
<img src="variant-surveillance-decision-tree-04.png" style="width:80.0%" alt=""><p class="caption"><strong>Figure 2.</strong> Other functions in the
<code>phylosamp</code> package can be used to determine the sample size
needed to accurately monitor variant prevalence, again assuming a single
cross-sectional sample.</p>
</div>
<p><br></p>
<p>In some cases, it may not be enough to simply <em>detect</em> a
variant—we may want to estimate its frequency in the population
(<strong>Figure 2</strong>). In that case, we can use the
<code><a href="../reference/vartrack_samplesize_prev.html">vartrack_samplesize_prev()</a></code> function to determine the sample
size needed to estimate the prevalence of a variant in a population
given some desired precision. This function requires the user to
specific a slightly different set of parameters:</p>
<table class="table">
<colgroup>
<col width="20%">
<col width="42%">
<col width="37%">
</colgroup>
<thead><tr class="header">
<th align="center">Param</th>
<th align="center">Variable Name</th>
<th><span style="display: inline-block; width:500px">Description</span></th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><strong><span class="math inline">\(P_{V_1}\)</span></strong></td>
<td align="center">p_v1</td>
<td>the desired minimum variant prevalence to be able to detect</td>
</tr>
<tr class="even">
<td align="center"><strong><span class="math inline">\(p\)</span></strong></td>
<td align="center">prob</td>
<td>the desired probability of detection</td>
</tr>
<tr class="odd">
<td align="center"><strong><span class="math inline">\(d\)</span></strong></td>
<td align="center">precision</td>
<td>the desired precision in the prevalence estimate</td>
</tr>
<tr class="even">
<td align="center"><strong><span class="math inline">\(\omega\)</span></strong></td>
<td align="center">omega</td>
<td>the sequencing success rate</td>
</tr>
<tr class="odd">
<td align="center"><strong><span class="math inline">\(\frac{C_{V_1}}{C_{V_2}}\)</span></strong></td>
<td align="center">c_ratio</td>
<td>the coefficient of detection ratio, calculated as the ratio of the
coefficients of variant 1 to variant 2 (can be calculated using
<code><a href="../reference/vartrack_cod_ratio.html">vartrack_cod_ratio()</a></code>)</td>
</tr>
</tbody>
</table>
<p>We then can calculate sample size as follows:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">c1_c2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vartrack_cod_ratio.html">vartrack_cod_ratio</a></span><span class="op">(</span>psi_v1<span class="op">=</span><span class="fl">0.25</span>, psi_v2<span class="op">=</span><span class="fl">0.4</span>, tau_a<span class="op">=</span><span class="fl">0.05</span>, tau_s<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/vartrack_samplesize_prev.html">vartrack_samplesize_prev</a></span><span class="op">(</span>p_v1<span class="op">=</span><span class="fl">0.1</span>,prob<span class="op">=</span><span class="fl">0.95</span>,precision<span class="op">=</span><span class="fl">0.25</span>, </span>
<span>                         omega<span class="op">=</span><span class="fl">0.8</span>, c_ratio<span class="op">=</span><span class="va">c1_c2</span>, sampling_freq<span class="op">=</span><span class="st">"xsect"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Calculating sample size for variant prevalence estimation assuming single cross-sectional sample</span></span></code></pre>
<pre><code><span><span class="co">## [1] 582.2843</span></span></code></pre>
<p>In other words, 583 samples must be processed in order to estimate
the population prevalence of a variant with at least 10% prevalence in
the population, with a precision of 25% of the true value, and a
confidence of 95% in the prevalence estimate. Again, we assume an 80%
success rate, which ensures successful characterization of 466 of the
583 samples selected for sequencing so they can be used to detect the
presence of a pathogen variant.</p>
</div>
<div class="section level5">
<h5 id="other-sampling-scenarios">Other sampling scenarios<a class="anchor" aria-label="anchor" href="#other-sampling-scenarios"></a>
</h5>
<p>For information on functions that can be used to estimate the sample
size given a periodic sampling approach, see <em>Estimating the sample
size needed for variant monitoring:</em> <a href="V4_SampleSizePeriodic.html"><em>periodic sampling</em></a>. These
functions can also be used in “reverse”, to calculate the probability of
detection given some sampling scheme, as in the <em>Estimating the
probability of detecting a variant</em> <a href="V3_ProbCrossSectional.html"><em>cross-sectional</em></a> and <a href="V5_ProbDetectPeriodic.html"><em>periodic</em></a> vignettes.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Shirlee Wohl, Elizabeth C Lee, Lucy D’Agostino McGowan, John R Giles, Justin Lessler.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
