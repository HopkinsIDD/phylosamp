<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Estimating sample size for transmission linkage from the false discovery rate â€¢ phylosamp</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Estimating sample size for transmission linkage from the false discovery rate">
<meta property="og:description" content="phylosamp">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-173221313-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-173221313-2');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">phylosamp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Transmission Linkage</li>
    <li>
      <a href="../articles/L1_FalseDiscoveryRate.html">Estimating the linkage false discovery rate</a>
    </li>
    <li>
      <a href="../articles/L2_SampleSize.html">Sample size calculations for transmission linkage</a>
    </li>
    <li>
      <a href="../articles/L3_SensitivitySpecificity.html">Estimating sensitivity and specificity of a linkage criteria</a>
    </li>
    <li>
      <a href="../articles/L4_IllustrativeExamples.html">Illustrative Examples</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Variant Tracking</li>
    <li>
      <a href="../articles/V1_CoefficientDetectionBias.html">Estimating bias in observed variant prevalence</a>
    </li>
    <li>
      <a href="../articles/V2_SampleSizeCrossSectional.html">Sample size calculations for variant tracking (cross-sectional sampling)</a>
    </li>
    <li>
      <a href="../articles/V3_ProbCrossSectional.html">Probability of detection and prevalence estimation (cross-sectional sampling)</a>
    </li>
    <li>
      <a href="../articles/V4_SampleSizePeriodic.html">Sample size calculations for variant tracking (periodic sampling)</a>
    </li>
    <li>
      <a href="../articles/V5_ProbDetectPeriodic.html">Probability of detection (periodic sampling)</a>
    </li>
    <li>
      <a href="../articles/V6_IllustrativeExample.html">Variant Surveillance Example</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/HopkinsIDD/phylosamp/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Estimating sample size for transmission linkage
from the false discovery rate</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/HopkinsIDD/phylosamp/blob/HEAD/vignettes/L2_SampleSize.Rmd" class="external-link"><code>vignettes/L2_SampleSize.Rmd</code></a></small>
      <div class="hidden name"><code>L2_SampleSize.Rmd</code></div>

    </div>

    
    
<p>In this vignette we describe how the linkage scenario functionality
can be used in reverse, to calculate the necessary sample size to
achieve a pre-specified false discovery rate. For example, this
calculation would be useful if a researcher is conducting a study for
which specimens have yet to be collected, but they want to ensure at
least 75% confidence in identified links. To calculate the proportion of
links that represent true transmission pairs, the user needs to provide
the sensitivity and specificity of the linkage criteria used, the final
size of the outbreak, and the desired minimum true discovery rate (<span class="math inline">\(1-\text{False Discovery Rate}\)</span>):</p>
<table class="table">
<colgroup>
<col width="20%">
<col width="42%">
<col width="37%">
</colgroup>
<thead><tr class="header">
<th align="center">Param</th>
<th align="center">Variable Name</th>
<th><span style="display: inline-block; width:500px">Description</span></th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><strong><span class="math inline">\(\eta\)</span></strong></td>
<td align="center">eta</td>
<td>the sensitivity of the linkage criteria for identifying transmission
links</td>
</tr>
<tr class="even">
<td align="center"><strong><span class="math inline">\(\chi\)</span></strong></td>
<td align="center">chi</td>
<td>the specificity of the linkage criteria for identifying transmission
links</td>
</tr>
<tr class="odd">
<td align="center"><strong><span class="math inline">\(N\)</span></strong></td>
<td align="center">N</td>
<td>the final size of the outbreak (total number of infections)</td>
</tr>
<tr class="even">
<td align="center"><strong><span class="math inline">\(R\)</span></strong></td>
<td align="center">R</td>
<td>the average reproductive number (also denoted <span class="math inline">\(R_\text{pop}\)</span>, see below)</td>
</tr>
<tr class="odd">
<td align="center"><strong><span class="math inline">\(\phi\)</span></strong></td>
<td align="center">phi</td>
<td>the desired minimum true discovery rate</td>
</tr>
</tbody>
</table>
<p>Imagine we are interested in collecting enough samples from an
outbreak of 100 cases to ensure that the identified links are correct at
least 75% of the time. The phylogenetic criteria we are using to
identify links has a sensitivity of 99% and a specificity of 99.5%, and
we assume multiple transmissions and multiple links are possible (i.e.,
we use the default <code>assumption</code> argument,
<code>mtml</code>).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/HopkinsIDD/phylosamp" class="external-link">phylosamp</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/translink_samplesize.html">translink_samplesize</a></span><span class="op">(</span>eta<span class="op">=</span><span class="fl">0.99</span>, chi<span class="op">=</span><span class="fl">0.995</span>, N<span class="op">=</span><span class="fl">100</span>, R<span class="op">=</span><span class="fl">1</span>, phi<span class="op">=</span><span class="fl">0.75</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 10</span></span></code></pre>
<p>Although 10 samples will ensure a false discovery rate of no more
than 25%, 10 samples may not provide enough data for analysis. In this
case, we can use the optional <code>min_pairs</code> parameter to
require that the expected number of links (calculated using the
<code><a href="../reference/translink_expected_links_obs.html">translink_expected_links_obs()</a></code> function) is at least some
minimum value:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/translink_samplesize.html">translink_samplesize</a></span><span class="op">(</span>eta<span class="op">=</span><span class="fl">0.99</span>, chi<span class="op">=</span><span class="fl">0.995</span>, N<span class="op">=</span><span class="fl">100</span>, R<span class="op">=</span><span class="fl">1</span>, phi<span class="op">=</span><span class="fl">0.75</span>, min_pairs<span class="op">=</span><span class="fl">30</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 50</span></span></code></pre>
<p>In another example, it may be crucial that links are identified with
high certainty. So we increase the minimum true discovery rate to
95%:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/translink_samplesize.html">translink_samplesize</a></span><span class="op">(</span>eta<span class="op">=</span><span class="fl">0.99</span>, chi<span class="op">=</span><span class="fl">0.995</span>, N<span class="op">=</span><span class="fl">100</span>, R<span class="op">=</span><span class="fl">1</span>, phi<span class="op">=</span><span class="fl">0.95</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in translink_samplesize(eta = 0.99, chi = 0.995, N = 100, R = 1, : Input values do no produce a viable solution</span></span></code></pre>
<p>This result suggests it is not possible to obtain such high certainty
with this linkage criteria. We can confirm this with the
<code>translink_tdr</code> function, which shows that even with 100%
sampling of this outbreak, we will correctly identify transmission links
no more than 80% of the time.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/translink_tdr.html">translink_tdr</a></span><span class="op">(</span>eta<span class="op">=</span><span class="fl">0.99</span>, chi<span class="op">=</span><span class="fl">0.995</span>, rho<span class="op">=</span><span class="fl">1</span>, M<span class="op">=</span><span class="fl">100</span>, R<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Calculating true discovery rate assuming multiple-transmission and multiple-linkage</span></span></code></pre>
<pre><code><span><span class="co">## [1] 0.8032454</span></span></code></pre>
<p>Further exploration of the <code><a href="../reference/translink_samplesize.html">translink_samplesize()</a></code>
function reveals that there are limited combinations of sensitivity and
specificity that produce reasonable sample sizes, and that specificity
in particular affects the minimum false discovery rate that can be
obtained. Therefore, correctly estimating sensitivity and specificity
are of key importance when using these functions to understand
transmission.</p>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Shirlee Wohl, Elizabeth C Lee, John R Giles, Justin Lessler.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
