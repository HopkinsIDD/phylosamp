<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Illustrative examples for evaluating transmission linkage â€¢ phylosamp</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Illustrative examples for evaluating transmission linkage">
<meta property="og:description" content="phylosamp">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-173221313-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-173221313-2');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">phylosamp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Transmission Linkage</li>
    <li>
      <a href="../articles/L1_FalseDiscoveryRate.html">Estimating the linkage false discovery rate</a>
    </li>
    <li>
      <a href="../articles/L2_SampleSize.html">Sample size calculations for transmission linkage</a>
    </li>
    <li>
      <a href="../articles/L3_SensitivitySpecificity.html">Estimating sensitivity and specificity of a linkage criteria</a>
    </li>
    <li>
      <a href="../articles/L4_IllustrativeExamples.html">Illustrative Examples</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Variant Tracking</li>
    <li>
      <a href="../articles/V1_CoefficientDetectionBias.html">Estimating bias in observed variant prevalence</a>
    </li>
    <li>
      <a href="../articles/V2_SampleSizeCrossSectional.html">Sample size calculations for variant tracking (cross-sectional sampling)</a>
    </li>
    <li>
      <a href="../articles/V3_ProbCrossSectional.html">Probability of detection and prevalence estimation (cross-sectional sampling)</a>
    </li>
    <li>
      <a href="../articles/V4_SampleSizePeriodic.html">Sample size calculations for variant tracking (periodic sampling)</a>
    </li>
    <li>
      <a href="../articles/V5_ProbDetectPeriodic.html">Probability of detection (periodic sampling)</a>
    </li>
    <li>
      <a href="../articles/V6_IllustrativeExample.html">Variant Surveillance Example</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/HopkinsIDD/phylosamp/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Illustrative examples for evaluating
transmission linkage</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/HopkinsIDD/phylosamp/blob/HEAD/vignettes/L4_IllustrativeExamples.Rmd" class="external-link"><code>vignettes/L4_IllustrativeExamples.Rmd</code></a></small>
      <div class="hidden name"><code>L4_IllustrativeExamples.Rmd</code></div>

    </div>

    
    
<p>In this vignette, we apply the functions provided to estimate
sensitivity and specificity and apply them to an Ebola-like pathogen. We
compare the results to those of a pathogen with a slower mutation rate
and higher reproductive number. Then, we will use these results to
calculate the false discovery rate of our linkage criteria (genetic
distance) given a sample size of 200 and a relevant population of 1000
infected individuals.</p>
<p>In the first part of this vignette, we use the function
<code><a href="../reference/gendist_roc_format.html">gendist_roc_format()</a></code>, which formats the results of
<code><a href="../reference/gendist_sensspec_cutoff.html">gendist_sensspec_cutoff()</a></code> for plotting ROC curves.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/HopkinsIDD/phylosamp" class="external-link">phylosamp</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/reshape" class="external-link">reshape2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">RColorBrewer</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/" class="external-link">cowplot</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="calculating-sensitivity-and-specificity-for-an-ebola-like-pathogen">Calculating sensitivity and specificity for an Ebola-like
pathogen<a class="anchor" aria-label="anchor" href="#calculating-sensitivity-and-specificity-for-an-ebola-like-pathogen"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ebola-like pathogen</span></span>
<span><span class="va">R</span> <span class="op">&lt;-</span> <span class="fl">1.5</span></span>
<span><span class="va">mut_rate</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="co"># use simulated generation distributions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"genDistSim"</span><span class="op">)</span></span>
<span><span class="va">mean_gens_pdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">genDistSim</span><span class="op">[</span><span class="va">genDistSim</span><span class="op">$</span><span class="va">R</span> <span class="op">==</span> <span class="va">R</span>, <span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get theoretical genetic distance dist based on mutation rate and generation parameters</span></span>
<span><span class="va">dists</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="../reference/gendist_distribution.html">gendist_distribution</a></span><span class="op">(</span>mut_rate <span class="op">=</span> <span class="va">mut_rate</span>, </span>
<span>                                            mean_gens_pdf <span class="op">=</span> <span class="va">mean_gens_pdf</span>, </span>
<span>                                            max_link_gens <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># reshape dataframe for plotting</span></span>
<span><span class="va">dists</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html" class="external-link">melt</a></span><span class="op">(</span><span class="va">dists</span>, </span>
<span>                        id.vars <span class="op">=</span> <span class="st">"dist"</span>, </span>
<span>                        variable.name <span class="op">=</span> <span class="st">"status"</span>, </span>
<span>                        value.name <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get sensitivity and specificity using the same paramters</span></span>
<span><span class="va">roc_calc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gendist_roc_format.html">gendist_roc_format</a></span><span class="op">(</span>cutoff <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">dists</span><span class="op">$</span><span class="va">dist</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>, </span>
<span>                               mut_rate <span class="op">=</span> <span class="va">mut_rate</span>,</span>
<span>                               mean_gens_pdf <span class="op">=</span> <span class="va">mean_gens_pdf</span><span class="op">)</span></span>
<span>  </span>
<span><span class="co"># get the optimal value for the ROC plot</span></span>
<span><span class="va">roc_optim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/optim_roc_threshold.html">optim_roc_threshold</a></span><span class="op">(</span><span class="va">roc_calc</span><span class="op">)</span></span>
<span><span class="va">threshold</span> <span class="op">&lt;-</span> <span class="va">roc_optim</span><span class="op">$</span><span class="va">cutoff</span></span>
<span><span class="va">optim_point</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">roc_optim</span><span class="op">$</span><span class="va">specificity</span>, <span class="va">roc_optim</span><span class="op">$</span><span class="va">sensitivity</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot the distributions of genetic distance</span></span>
<span><span class="va">pal</span> <span class="op">&lt;-</span> <span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">5</span>, <span class="st">"PuOr"</span><span class="op">)</span></span>
<span>  </span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dists</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">dist</span>, y<span class="op">=</span><span class="va">prob</span>, fill<span class="op">=</span><span class="va">status</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">0.5</span>, stat<span class="op">=</span><span class="st">"identity"</span>, position<span class="op">=</span><span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">""</span>, values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pal</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>, <span class="va">pal</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">35</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.4</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">'Genetic distance'</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">'Density'</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">'none'</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept<span class="op">=</span><span class="va">threshold</span>, linetype<span class="op">=</span><span class="fl">2</span>, size<span class="op">=</span><span class="fl">0.5</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span>
<span>  </span>
<span><span class="co"># add ROC curve on top</span></span>
<span><span class="va">r1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">roc_calc</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">specificity</span>, y<span class="op">=</span><span class="va">sensitivity</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">xlim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">optim_point</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, y<span class="op">=</span><span class="va">optim_point</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>               size <span class="op">=</span> <span class="fl">3</span>, stroke<span class="op">=</span><span class="fl">1</span>, shape<span class="op">=</span><span class="fl">21</span>, fill <span class="op">=</span> <span class="st">"chartreuse"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span>slope<span class="op">=</span><span class="fl">1</span>, intercept <span class="op">=</span> <span class="fl">0</span>, linetype<span class="op">=</span><span class="fl">2</span>, alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"1-specificity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span><span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/ggdraw.html" class="external-link">ggdraw</a></span><span class="op">(</span><span class="va">p1</span><span class="op">)</span> <span class="op">+</span> <span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/draw_plot.html" class="external-link">draw_plot</a></span><span class="op">(</span><span class="va">r1</span>, hjust<span class="op">=</span><span class="op">-</span><span class="fl">0.16</span>, vjust<span class="op">=</span><span class="op">-</span><span class="fl">0.16</span>, scale<span class="op">=</span><span class="fl">0.6</span><span class="op">)</span></span></code></pre></div>
<p><img src="L4_IllustrativeExamples_files/figure-html/gen_dist_compare_ebov-1.png" width="576"></p>
</div>
<div class="section level3">
<h3 id="optimal-values-for-an-ebola-like-pathogen">Optimal values for an Ebola-like pathogen<a class="anchor" aria-label="anchor" href="#optimal-values-for-an-ebola-like-pathogen"></a>
</h3>
<p>Using the closest-to-corner method, the optimal genetic distance
threshold for this pathogen is:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">threshold</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 5</span></span></code></pre>
<p>And the sensitivity and specificity at this threshold is:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">roc_optim</span><span class="op">$</span><span class="va">sensitivity</span> <span class="co">## sensitivity</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.9963402</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1</span> <span class="op">-</span> <span class="va">roc_optim</span><span class="op">$</span><span class="va">specificity</span> <span class="co">## specificity</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.9801562</span></span></code></pre>
<p>We repeat the above plot for a pathogen with a higher reproductive
number and lower mutation rate:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># faster-spreading pathogen</span></span>
<span><span class="va">R</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">mut_rate</span> <span class="op">&lt;-</span> <span class="fl">0.2</span></span>
<span></span>
<span><span class="va">mean_gens_pdf</span> <span class="op">&lt;-</span> <span class="va">genDistSim</span><span class="op">[</span><span class="va">genDistSim</span><span class="op">[</span><span class="st">"R"</span><span class="op">]</span><span class="op">==</span><span class="va">R</span><span class="op">]</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">genDistSim</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="calculating-sensitivity-and-specificity-for-a-faster-spreading-slower-mutating-pathogen">Calculating sensitivity and specificity for a faster-spreading,
slower mutating pathogen<a class="anchor" aria-label="anchor" href="#calculating-sensitivity-and-specificity-for-a-faster-spreading-slower-mutating-pathogen"></a>
</h3>
<p><img src="L4_IllustrativeExamples_files/figure-html/gen_dist_mev_plot-1.png" width="576"></p>
</div>
<div class="section level3">
<h3 id="optimal-values-for-a-faster-spreading-slower-mutating-pathogen">Optimal values for a faster-spreading, slower mutating pathogen<a class="anchor" aria-label="anchor" href="#optimal-values-for-a-faster-spreading-slower-mutating-pathogen"></a>
</h3>
<p>For this pathogen, the optimal genetic distance threshold is:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">threshold</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1</span></span></code></pre>
<p>And the sensitivity and specificity at this threshold is:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">roc_optim</span><span class="op">[</span><span class="va">roc_optim</span><span class="op">$</span><span class="va">cutoff</span><span class="op">==</span><span class="va">threshold</span>,<span class="op">]</span><span class="op">$</span><span class="va">sensitivity</span> <span class="co">## sensitivity</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.8187308</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1</span> <span class="op">-</span> <span class="va">roc_optim</span><span class="op">[</span><span class="va">roc_optim</span><span class="op">$</span><span class="va">cutoff</span><span class="op">==</span><span class="va">threshold</span>,<span class="op">]</span><span class="op">$</span><span class="va">specificity</span> <span class="co">## specificity</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.8539157</span></span></code></pre>
<p>It is well understood that genetic distance is a much more accurate
predictor of transmission linkage for pathogens with higher mutation
rates and slower spread, as shown clearly in this example (lower
sensitivity and specificity in the second example). Genetic distance is
clearly not an appropriate metric for all pathogens, but more
sophisticated linkage criteria â€“ especially those that incorporate
epidemiological information as well â€“ may produce better results.</p>
</div>
<div class="section level3">
<h3 id="calculating-the-false-discovery-rate-of-genetic-distance-as-a-linkage-criteria">Calculating the false discovery rate of genetic distance as a
linkage criteria<a class="anchor" aria-label="anchor" href="#calculating-the-false-discovery-rate-of-genetic-distance-as-a-linkage-criteria"></a>
</h3>
<p>This is reflected in our confidence in identifying linked infection
pairs. Assuming a sample size of 200, a relevant population of 1000, and
the genetic distance threshold and associated sensitivity and
specificity for each pathogen we get:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/translink_tdr.html">translink_tdr</a></span><span class="op">(</span>eta<span class="op">=</span><span class="fl">0.9963402</span>, chi<span class="op">=</span><span class="fl">0.9801562</span>, rho<span class="op">=</span><span class="fl">0.20</span>, M<span class="op">=</span><span class="fl">200</span>, R<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="co"># ebola-like pathogen</span></span></code></pre></div>
<pre><code><span><span class="co">## Calculating true discovery rate assuming multiple-transmission and multiple-linkage</span></span></code></pre>
<pre><code><span><span class="co">## [1] 0.09183886</span></span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/translink_tdr.html">translink_tdr</a></span><span class="op">(</span>eta<span class="op">=</span><span class="fl">0.8187308</span>, chi<span class="op">=</span><span class="fl">0.8539157</span>, rho<span class="op">=</span><span class="fl">0.20</span>, M<span class="op">=</span><span class="fl">200</span>, R<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="co"># slower-mutating pathogen</span></span></code></pre></div>
<pre><code><span><span class="co">## Calculating true discovery rate assuming multiple-transmission and multiple-linkage</span></span></code></pre>
<pre><code><span><span class="co">## [1] 0.01116204</span></span></code></pre>
<p>As a final note, we remind the reader that the specificity of the
linkage criteria has a significant bearing on the true/false discovery
rate, and that high true discovery rates require a specificity upwards
of 0.999. Linkage criteria more complex than genetic distance may be
needed to achieve this value.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Shirlee Wohl, Elizabeth C Lee, John R Giles, Justin Lessler.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
