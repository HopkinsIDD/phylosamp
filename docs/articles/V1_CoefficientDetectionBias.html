<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Estimating bias in observed variant prevalence • phylosamp</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Estimating bias in observed variant prevalence">
<meta property="og:description" content="phylosamp">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-173221313-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-173221313-2');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">phylosamp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Transmission Linkage</li>
    <li>
      <a href="../articles/L1_FalseDiscoveryRate.html">Estimating the linkage false discovery rate</a>
    </li>
    <li>
      <a href="../articles/L2_SampleSize.html">Sample size calculations for transmission linkage</a>
    </li>
    <li>
      <a href="../articles/L3_SensitivitySpecificity.html">Estimating sensitivity and specificity of a linkage criteria</a>
    </li>
    <li>
      <a href="../articles/L4_IllustrativeExamples.html">Illustrative Examples</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Variant Tracking</li>
    <li>
      <a href="../articles/V1_CoefficientDetectionBias.html">Estimating bias in observed variant prevalence</a>
    </li>
    <li>
      <a href="../articles/V2_SampleSizeCrossSectional.html">Sample size calculations for variant tracking (cross-sectional sampling)</a>
    </li>
    <li>
      <a href="../articles/V3_ProbCrossSectional.html">Probability of detection and prevalence estimation (cross-sectional sampling)</a>
    </li>
    <li>
      <a href="../articles/V4_SampleSizePeriodic.html">Sample size calculations for variant tracking (periodic sampling)</a>
    </li>
    <li>
      <a href="../articles/V5_ProbDetectPeriodic.html">Probability of detection (periodic sampling)</a>
    </li>
    <li>
      <a href="../articles/V6_IllustrativeExample.html">Variant Surveillance Example</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/HopkinsIDD/phylosamp/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Estimating bias in observed variant
prevalence</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/HopkinsIDD/phylosamp/blob/HEAD/vignettes/V1_CoefficientDetectionBias.Rmd" class="external-link"><code>vignettes/V1_CoefficientDetectionBias.Rmd</code></a></small>
      <div class="hidden name"><code>V1_CoefficientDetectionBias.Rmd</code></div>

    </div>

    
    
<p>This vignette provides an overview of functions that are useful for
understanding bias in the detection of pathogen variants and estimation
of their prevalence in a population. Central to these functions is the
assumption that biological differences in pathogen variants may affect
how infections are tested and characterized. For example, a variant that
causes more severe clinical outcomes may result in a higher testing
rate, since more individuals get sick enough to present at a healthcare
facility. This higher testing rate may mean that a higher proportion of
the samples selected for molecular characterization (e.g., sequencing)
belong to this variant than the true underlying frequency of this
variant in the population.</p>
<p>The combination of the factors that may affect the detection and
characterization of a particular variant can be summarized in a
parameter termed the <em>coefficient of detection</em>, which in turn
can be estimated from the following parameters. This is not a
comprehensive list of parameters, but rather the parameters currently
implemented in the <code>phylosamp</code> package, since they are likely
to have a significant effect on variant detection and prevalence
estimation:</p>
<table class="table">
<colgroup>
<col width="20%">
<col width="42%">
<col width="37%">
</colgroup>
<thead><tr class="header">
<th align="center">Param</th>
<th align="center">Variable Name</th>
<th><span style="display: inline-block; width:500px">Description</span></th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><strong><span class="math inline">\(\phi_{V_1}\)</span></strong></td>
<td align="center">phi_v1</td>
<td>the probability that a tested infection caused by variant 1 results
in a positive test (sensitivity)</td>
</tr>
<tr class="even">
<td align="center"><strong><span class="math inline">\(\phi_{V_2}\)</span></strong></td>
<td align="center">phi_v2</td>
<td>the probability that a tested infection caused by variant 2 results
in a positive test (sensitivity)</td>
</tr>
<tr class="odd">
<td align="center"><strong><span class="math inline">\(\gamma_{V_1}\)</span></strong></td>
<td align="center">gamma_v1</td>
<td>the probability that a detected infection caused by variant 1 meets
some quality threshold</td>
</tr>
<tr class="even">
<td align="center"><strong><span class="math inline">\(\gamma_{V_2}\)</span></strong></td>
<td align="center">gamma_v2</td>
<td>the probability that a detected infection caused by variant 2 meets
some quality threshold</td>
</tr>
<tr class="odd">
<td align="center"><strong><span class="math inline">\(\alpha_{V_1}\)</span></strong></td>
<td align="center">alpha_v1</td>
<td>the probability that an infection caused by variant 1 is
asymptomatic</td>
</tr>
<tr class="even">
<td align="center"><strong><span class="math inline">\(\alpha_{V_2}\)</span></strong></td>
<td align="center">alpha_v2</td>
<td>the probability that an infection caused by variant 2 is
asymptomatic</td>
</tr>
<tr class="odd">
<td align="center"><strong><span class="math inline">\(\beta_{a}\)</span></strong></td>
<td align="center">beta_a</td>
<td>the probability of testing an asymptomatic infection (any
variant)</td>
</tr>
<tr class="even">
<td align="center"><strong><span class="math inline">\(\beta_{s}\)</span></strong></td>
<td align="center">beta_s</td>
<td>the probability of testing a symptomatic infection (any
variant)</td>
</tr>
</tbody>
</table>
<p>While it may be difficult to estimate all of the parameters needed to
estimate this coefficient, we find that only the <em>ratio</em> in the
coefficients of detection for two variants (more commonly, the variant
of interest and the values for the rest of the pathogen population) is
necessary for understanding the biases in a sample. Therefore, it may
not be necessary to estimate the true value of each parameter, provided
we can estimate the ratio between their values for the two variants in
question. We can use the <code><a href="../reference/vartrack_cod_ratio.html">vartrack_cod_ratio()</a></code> function to
estimate the coefficient of detection ratio, only providing parameters
which are expected to differ between variants. The ratio between any
variants not provided is assumed to be equal to one.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/HopkinsIDD/phylosamp" class="external-link">phylosamp</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/vartrack_cod_ratio.html">vartrack_cod_ratio</a></span><span class="op">(</span>phi_v1<span class="op">=</span><span class="fl">0.975</span>, phi_v2<span class="op">=</span><span class="fl">0.95</span>, gamma_v1<span class="op">=</span><span class="fl">0.8</span>, gamma_v2<span class="op">=</span><span class="fl">0.6</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1.368421</span></span></code></pre>
<p>In this case, we assume that the testing sensitivity is higher for
variant 1 (<span class="math inline">\(\phi_{V_1}=0.975\)</span>) than
it is for the rest of the pathogen population (<span class="math inline">\(\phi_{V_2}=0.95\)</span>). Similarly, we assume
that samples containing variant 1 have a higher chance of
characterization success (by sequencing or another method; <span class="math inline">\(\gamma_{V_1}=0.8\)</span>) than other samples
(<span class="math inline">\(\gamma_{V_2}=0.6\)</span>).</p>
<p>We also assume that the asymptomatic rate is the same between
variants, and thus this parameter does not need to be provided. When the
asymptomatic rate is the same between variants, the testing probability
(which could differ for symptomatic and asymptomatic infections, but is
assumed to be the same between variants, since the variant is not
usually known at the time of testing) no longer affects the coefficient
of detection ratio, and thus also does not need to be provided.</p>
<p>With the coefficient of detection ratio in hand, we can now use other
package functions to estimate how this ratio will affect our observed
variant frequency. For example, we can use the
<code><a href="../reference/varfreq_obs_freq.html">varfreq_obs_freq()</a></code> function to estimate how changing
parameters such as the testing sensitivity, testing frequency,
asymptomatic rate, etc. will affect the variant frequency we expect to
see in our pool of tested samples, given some underlying true variant
prevalence:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/varfreq_obs_freq.html">varfreq_obs_freq</a></span><span class="op">(</span>p_v1<span class="op">=</span><span class="fl">0.2</span>, c_ratio<span class="op">=</span><span class="fl">1.368</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.2548435</span></span></code></pre>
<p>Given the coefficient of detection ratio calculated above (<span class="math inline">\(1.368\)</span>) we can see that we would observe
the variant of interest at approximately 25% prevalence in any
well-mixed sample, even though the true underlying prevalence is only
20%. This enrichment may reduce the sample size needed to detect the
variant when present at low frequencies, but may make it difficult to
estimate changes in the variant frequency with precision.</p>
<p>We can use a separate function to estimate the multiplicative bias in
the observed variant prevalence estimated above—in other words, the
observed variant prevalence divided by the true variance prevalence:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/varfreq_expected_mbias.html">varfreq_expected_mbias</a></span><span class="op">(</span>p_v1<span class="op">=</span><span class="fl">0.2</span>, c_ratio<span class="op">=</span><span class="fl">1.367</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1.273523</span></span></code></pre>
<p>As expected, this value is the result from the
<code><a href="../reference/varfreq_obs_freq.html">varfreq_obs_freq()</a></code> function divided by the true underlying
prevalence. This value tells use that we are overestimating the variant
of interest frequency by roughly 25%.</p>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Shirlee Wohl, Elizabeth C Lee, John R Giles, Justin Lessler.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
