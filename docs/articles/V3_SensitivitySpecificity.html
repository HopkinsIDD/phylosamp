<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Estimating the sensitivity and specificity of a linkage criteria • phylosamp</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Estimating the sensitivity and specificity of a linkage criteria">
<meta property="og:description" content="phylosamp">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-173221313-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-173221313-2');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">phylosamp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/V1_FalseDicoveryRate.html">Estimating the false discovery rate from sample size</a>
    </li>
    <li>
      <a href="../articles/V2_SampleSize.html">Estimating sample size from the false discovery rate</a>
    </li>
    <li>
      <a href="../articles/V3_SensitivitySpecificity.html">Estimating the sensitivity and specificity of a linkage criteria</a>
    </li>
    <li>
      <a href="../articles/V4_FullExamples.html">Illustrative examples</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/HopkinsIDD/phylosamp/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="V3_SensitivitySpecificity_files/header-attrs-2.1/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Estimating the sensitivity and specificity of a linkage criteria</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/HopkinsIDD/phylosamp/blob/master/vignettes/V3_SensitivitySpecificity.Rmd"><code>vignettes/V3_SensitivitySpecificity.Rmd</code></a></small>
      <div class="hidden name"><code>V3_SensitivitySpecificity.Rmd</code></div>

    </div>

    
    
<style type="text/css">

h1.title {
  font-size: 22px
}

</style>
<p>The sensitivity and specificity of the linkage criteria to distinguish between linked and unlinked infection pairs can be determined by applying a specific linkage criteria to an existing dataset for which the true transmission events are known, and then extrapoloating these results to a new or larger set of data for which transmission are not known.</p>
<p>However, there are many scenarios in which this existing dataset is not available or representative of the desired sampling population. In this package, we provide a method for calculating the sensitivity and specificity of genetic distance – the number of mutations between pathogen genome sequences – as a linkage criteria. Further research is needed to extend this method beyond genetic distance as the linkage metric.</p>
<p>In this package, we provide a function (<code><a href="../reference/sens_spec_calc.html">sens_spec_calc()</a></code>) to calculate the sensitivity and specificity when using a specific genetic distance threshold (e.g. 2 mutations) or a vector of candidate thresholds (e.g. 1-10 mutations). Note that samples separated by a genetic distance of less than the cutoff are considered linked, so the minimum cutoff to consider is 1 (linked cases have identical genomes).</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="../reference/sens_spec_calc.html">sens_spec_calc</a></span>(<span class="kw">cutoff</span><span class="kw">=</span><span class="fl">2</span>,
               <span class="kw">mut_rate</span><span class="kw">=</span><span class="fl">1</span>,
               <span class="kw">mean_gens_pdf</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.02</span>,<span class="fl">0.08</span>,<span class="fl">0.15</span>,<span class="fl">0.75</span>),
               <span class="kw">max_link_gens</span><span class="kw">=</span><span class="fl">1</span>)</pre></body></html></div>
<pre><code>##      cutoff sensitivity specificity
## [1,]      2   0.7357589   0.8662894</code></pre>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu"><a href="../reference/sens_spec_calc.html">sens_spec_calc</a></span>(<span class="kw">cutoff</span><span class="kw">=</span><span class="fl">1</span>:<span class="fl">10</span>,
               <span class="kw">mut_rate</span><span class="kw">=</span><span class="fl">1</span>,
               <span class="kw">mean_gens_pdf</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.02</span>,<span class="fl">0.08</span>,<span class="fl">0.15</span>,<span class="fl">0.75</span>),
               <span class="kw">max_link_gens</span><span class="kw">=</span><span class="fl">1</span>)</pre></body></html></div>
<pre><code>##       cutoff sensitivity specificity
##  [1,]      1   0.3678794 0.967314682
##  [2,]      2   0.7357589 0.866289434
##  [3,]      3   0.9196986 0.697765199
##  [4,]      4   0.9810118 0.499227295
##  [5,]      5   0.9963402 0.316627604
##  [6,]      6   0.9994058 0.178637743
##  [7,]      7   0.9999168 0.090198436
##  [8,]      8   0.9999898 0.041044514
##  [9,]      9   0.9999989 0.016951040
## [10,]     10   0.9999999 0.006396198</code></pre>
<p>This method requires knowledge of the pathogen mutation rate, the distribution of generations between cases, and the number of generations between cases considered linked. We break down each of these inputs in turn:</p>
<div id="the-mutation-rate-of-the-pathogen" class="section level5">
<h5 class="hasAnchor">
<a href="#the-mutation-rate-of-the-pathogen" class="anchor"></a>1. The mutation rate of the pathogen</h5>
<p>The mutation rate of the pathogen must be provided in mutations per genome per generation, and represents the average number of mutations observed between the genomes of an infector/infectee pair.</p>
<p>Many pathogen mutation rates are reported in substitutions per site per year. We provide an example of converting the substitution rate for Ebola virus (roughly <span class="math inline">\(1.2\times 10^{-3} subs/site/year\)</span>) to mutations (used interchangeably with substitutions for this purpose) per genome per generation:</p>
<p><span class="math display">\[ 1.2\times 10^{-3}\:subs/site/year \:\times\:\frac{19000\text{ sites}}{1\text{ genome}}
\:\times\:\frac{1\text{ year}}{365\text{ days}}\:\times\:\frac{15\text{ days}}{1\text{ generation}}
= 0.94\:subs/genome/generation\]</span></p>
<p>In other words, assuming an approximate generation time of 15 days, we would expect to see 1 mutation per generation of transmission.</p>
</div>
<div id="the-distribution-of-generations-between-cases" class="section level5">
<h5 class="hasAnchor">
<a href="#the-distribution-of-generations-between-cases" class="anchor"></a>2. The distribution of generations between cases</h5>
<p>The number of generations between all pairs of cases in the population is key to determining how many of them are actually linked (separated by less than <code>max_link_gens</code> generations of transmission), which in turn is used to calculate the sensitivity and specificity. This distribution is not trivial, but depends on the reproductive number of the pathogen. We have simulated this distribution for values of <span class="math inline">\(R\)</span> between 1.3 and 18 and averaged the results of 1000 simulations for each value. The results are provided as part of this package at <code>data/sim_distance_dist.csv</code> and can be used as a reasonable proxy for the generation distribution for large outbreaks.</p>
<p>We provide an example of using these results for given the mutation rate (~1) and reproductive number (1.5) of an Ebola-like virus:</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">R</span> <span class="kw">&lt;-</span> <span class="fl">1.5</span>

<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"gen_dist_sim"</span>)
<span class="no">mgd</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="no">gen_dist_sim</span>[<span class="no">gen_dist_sim</span>$<span class="no">R</span> <span class="kw">==</span> <span class="no">R</span>, -(<span class="fl">1</span>:<span class="fl">2</span>)])

<span class="fu"><a href="../reference/sens_spec_calc.html">sens_spec_calc</a></span>(<span class="kw">cutoff</span><span class="kw">=</span><span class="fl">1</span>:<span class="fl">10</span>,
               <span class="kw">mut_rate</span><span class="kw">=</span><span class="fl">1</span>,
               <span class="kw">mean_gens_pdf</span><span class="kw">=</span><span class="no">mgd</span>,
               <span class="kw">max_link_gens</span><span class="kw">=</span><span class="fl">1</span>)</pre></body></html></div>
<pre><code>##       cutoff sensitivity specificity
##  [1,]      1   0.3678794   0.9992910
##  [2,]      2   0.7357589   0.9971700
##  [3,]      3   0.9196986   0.9933593
##  [4,]      4   0.9810118   0.9877469
##  [5,]      5   0.9963402   0.9801562
##  [6,]      6   0.9994058   0.9703223
##  [7,]      7   0.9999168   0.9579376
##  [8,]      8   0.9999898   0.9426909
##  [9,]      9   0.9999989   0.9242939
## [10,]     10   0.9999999   0.9025040</code></pre>
<p>We can then choose the optimal threshold and the associated sensitivity and specificity for our transmission study. Many methods exist for choosing the optimal threshold, including the Youden index, closest to corner, etc. Using either of these methods, the optimal threshold in this example is 5 mutations. In other words, cases separate by less than 5 mutations will be considered linked given this linkage criteria, which has a sensitivity of 98.1% and a specficity of 98.7%.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by John R Giles, Shirlee Wohl, Justin Lessler.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
