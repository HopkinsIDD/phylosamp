<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Estimating the sample size needed for variant monitoring • phylosamp</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Estimating the sample size needed for variant monitoring">
<meta property="og:description" content="phylosamp">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-173221313-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-173221313-2');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">phylosamp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Transmission Linkage</li>
    <li>
      <a href="../articles/L1_FalseDiscoveryRate.html">Estimating the linkage false discovery rate</a>
    </li>
    <li>
      <a href="../articles/L2_SampleSize.html">Sample size calculations for transmission linkage</a>
    </li>
    <li>
      <a href="../articles/L3_SensitivitySpecificity.html">Estimating sensitivity and specificity of a linkage criteria</a>
    </li>
    <li>
      <a href="../articles/L4_IllustrativeExamples.html">Illustrative Examples</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Variant Tracking</li>
    <li>
      <a href="../articles/V1_CoefficientDetectionBias.html">Estimating bias in observed variant prevalence</a>
    </li>
    <li>
      <a href="../articles/V2_SampleSizeCrossSectional.html">Sample size calculations for variant tracking (cross-sectional sampling)</a>
    </li>
    <li>
      <a href="../articles/V3_ProbCrossSectional.html">Probability of detection and prevalence estimation (cross-sectional sampling)</a>
    </li>
    <li>
      <a href="../articles/V4_SampleSizePeriodic.html">Sample size calculations for variant tracking (periodic sampling)</a>
    </li>
    <li>
      <a href="../articles/V5_ProbDetectPeriodic.html">Probability of detection (periodic sampling)</a>
    </li>
    <li>
      <a href="../articles/V6_IllustrativeExample.html">Variant Surveillance Example</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/HopkinsIDD/phylosamp/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Estimating the sample size needed for variant
monitoring</h1>
            <h3 data-toc-skip class="subtitle">Periodic sampling</h3>
            
      
      <small class="dont-index">Source: <a href="https://github.com/HopkinsIDD/phylosamp/blob/HEAD/vignettes/V4_SampleSizePeriodic.Rmd" class="external-link"><code>vignettes/V4_SampleSizePeriodic.Rmd</code></a></small>
      <div class="hidden name"><code>V4_SampleSizePeriodic.Rmd</code></div>

    </div>

    
    
<p>This vignette provides an overview of the functions that can be used
to estimate the sample size needed to detect a pathogen variant in a
population, given a periodic sampling scheme.</p>
<div class="section level5">
<h5 id="variant-detection">Variant detection<a class="anchor" aria-label="anchor" href="#variant-detection"></a>
</h5>
<div class="figure">
<img src="variant-surveillance-decision-tree-05.png" style="width:80.0%" alt=""><p class="caption"><strong>Figure 1.</strong> Identifying the key
question (detection vs prevalence) is the second step in designing a
pathogen surveillance system. Determining the sample size needed to
answer this question then requires determining the sampling frequency,
i.e., if samples will be collected and sequenced just once
(cross-sectional sampling) or with some regularity over a period of time
(periodic surveillance).</p>
</div>
<p><br></p>
<p>By specifying <code>sampling_freq = "cont"</code>, the
<code><a href="../reference/vartrack_samplesize_detect.html">vartrack_samplesize_detect()</a></code> function can be used to
calculate the sample size needed to detect a particular variant in the
population within a specific number of days since its introduction, OR
by the time a variant reaches a specific frequency. As when specifying
cross-sectional sampling with <code>sampling_freq = "xsect"</code> (see
<em>Estimating the sample size needed for variant monitoring:</em> <a href="V2_SampleSizeCrossSectional.html"><em>cross-sectional
sampling</em></a> for details), applying the
<code><a href="../reference/vartrack_samplesize_detect.html">vartrack_samplesize_detect()</a></code> function to calculate a sample
size assuming periodic sampling (<strong>Figure 1</strong>) requires
knowledge of the coefficient of detection ratio between two pathogen
variants (or, more commonly, one variant and the rest of the pathogen
population). The coefficient of detection ratio for two variants can be
calculated using the <code><a href="../reference/vartrack_cod_ratio.html">vartrack_cod_ratio()</a></code> function (see <a href="V1_CoefficientDetectionBias.html"><em>Estimating bias in observed
variant prevalence</em></a>). Since we are only interested in the ratio
of the coefficients of detection, applying this function only requires
providing parameters which are expected to differ between variants. The
ratio between any variants not provided is assumed to be equal to
one.</p>
<p>Once we have an estimate of the coefficient of detection ratio, we
can calculate the sample size needed for detection from the following
parameters:</p>
<table class="table">
<colgroup>
<col width="20%">
<col width="42%">
<col width="37%">
</colgroup>
<thead><tr class="header">
<th align="center">Param</th>
<th align="center">Variable Name</th>
<th><span style="display: inline-block; width:500px">Description</span></th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><strong><span class="math inline">\(p\)</span></strong></td>
<td align="center">prob</td>
<td>the desired probability of detection</td>
</tr>
<tr class="even">
<td align="center"><strong><span class="math inline">\(t\)</span></strong></td>
<td align="center">t</td>
<td>the number of days after introduction a variant should be detected
by</td>
</tr>
<tr class="odd">
<td align="center"><strong><span class="math inline">\(P_{V_1}\)</span></strong></td>
<td align="center">p_v1</td>
<td>the desired prevalence to detect a variant by</td>
</tr>
<tr class="even">
<td align="center"><strong><span class="math inline">\(P_{0_{V_1}}\)</span></strong></td>
<td align="center">p0_v1</td>
<td>the initial variant prevalence (# introductions / population
size)</td>
</tr>
<tr class="odd">
<td align="center"><strong><span class="math inline">\(r_{V_1}\)</span></strong></td>
<td align="center">r_v1</td>
<td>the estimated logistic growth rate of the variant (per day)</td>
</tr>
<tr class="even">
<td align="center"><strong><span class="math inline">\(\omega\)</span></strong></td>
<td align="center">omega</td>
<td>the sequencing success rate</td>
</tr>
<tr class="odd">
<td align="center"><strong><span class="math inline">\(\frac{C_{V_1}}{C_{V_2}}\)</span></strong></td>
<td align="center">c_ratio</td>
<td>the coefficient of detection ratio, calculated as the ratio of the
coefficients of variant 1 to variant 2 (can be calculated using
<code>calc_cod_ratio()</code>)</td>
</tr>
</tbody>
</table>
<p>To calculate the sample size needed for detection assuming periodic
sampling, we must provide <em>either</em> the number of days after
introduction a variant should be detected by (<span class="math inline">\(t\)</span>) OR the desired prevalence to detect a
variant by (<span class="math inline">\(P_{V_1}\)</span>), but not both.
All other parameters listed above are required.</p>
<p>Therefore, if we would like to know the sample size needed per day to
ensure detection of a variant by the time it reaches 1% prevalence in
the population, we can apply the
<code><a href="../reference/vartrack_samplesize_detect.html">vartrack_samplesize_detect()</a></code> function as follows:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/HopkinsIDD/phylosamp" class="external-link">phylosamp</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">c1_c2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vartrack_cod_ratio.html">vartrack_cod_ratio</a></span><span class="op">(</span>phi_v1<span class="op">=</span><span class="fl">0.975</span>, phi_v2<span class="op">=</span><span class="fl">0.95</span>, gamma_v1<span class="op">=</span><span class="fl">0.8</span>, gamma_v2<span class="op">=</span><span class="fl">0.6</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/vartrack_samplesize_detect.html">vartrack_samplesize_detect</a></span><span class="op">(</span>prob<span class="op">=</span><span class="fl">0.95</span>, p_v1<span class="op">=</span><span class="fl">0.01</span>, p0_v1<span class="op">=</span><span class="fl">3</span><span class="op">/</span><span class="fl">10000</span>, r_v1<span class="op">=</span><span class="fl">0.1</span>, </span>
<span>                           omega<span class="op">=</span><span class="fl">0.8</span>, c_ratio<span class="op">=</span><span class="va">c1_c2</span>, sampling_freq<span class="op">=</span><span class="st">"cont"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Calculating sample size for variant detection assuming periodic sampling</span></span></code></pre>
<pre><code><span><span class="co">## [1] 25.81341</span></span></code></pre>
<p>In other words, 26 samples <em>per day</em> are needed to detect a
variant at 1% (or higher) in a population with 95% probability of
detection, given a coefficient of detection ratio (<span class="math inline">\(\frac{C_{V_1}}{C_{V_2}}\)</span>) of 1.368 (as
calculated from parameters listed above). This assumes that all samples
sequenced (or otherwise characterized) will be successful. We assume an
80% success rate (<span class="math inline">\(\omega = 0.8\)</span>),
which ensures the 21 high quality data points that can be used to detect
the presence of a pathogen variant from a selection of 27 samples. If
sequencing will occur on a weekly basis, this means we need to process
<span class="math inline">\(26*7=182\)</span> samples per week (ideally
from infections spread evenly over the 7 days) to ensure we detect a
variant by the time it reaches 1% frequency in the population.</p>
</div>
<div class="section level5">
<h5 id="variant-prevalence">Variant prevalence<a class="anchor" aria-label="anchor" href="#variant-prevalence"></a>
</h5>
<div class="figure">
<img src="variant-surveillance-decision-tree-06.png" style="width:80.0%" alt=""><p class="caption"><strong>Figure 2.</strong> Other functions in the
<code>phylosamp</code> package can be used to determine the sample size
needed to accurately monitor variant prevalence given a periodic
sampling strategy.</p>
</div>
<p><br></p>
<p>If instead we are interested in detecting a variant within the first
month of its introduction into the population (assuming all other
parameters are the same as above), we can use the
<code><a href="../reference/vartrack_samplesize_detect.html">vartrack_samplesize_detect()</a></code> function as follows:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">c1_c2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vartrack_cod_ratio.html">vartrack_cod_ratio</a></span><span class="op">(</span>phi_v1<span class="op">=</span><span class="fl">0.975</span>, phi_v2<span class="op">=</span><span class="fl">0.95</span>, gamma_v1<span class="op">=</span><span class="fl">0.8</span>, gamma_v2<span class="op">=</span><span class="fl">0.6</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/vartrack_samplesize_detect.html">vartrack_samplesize_detect</a></span><span class="op">(</span>prob<span class="op">=</span><span class="fl">0.95</span>, t<span class="op">=</span><span class="fl">30</span>, p0_v1<span class="op">=</span><span class="fl">3</span><span class="op">/</span><span class="fl">10000</span>, r_v1<span class="op">=</span><span class="fl">0.1</span>, </span>
<span>                           omega<span class="op">=</span><span class="fl">0.8</span>, c_ratio<span class="op">=</span><span class="va">c1_c2</span>, sampling_freq<span class="op">=</span><span class="st">"cont"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Calculating sample size for variant detection assuming periodic sampling</span></span></code></pre>
<pre><code><span><span class="co">## [1] 47.98564</span></span></code></pre>
<p>In this case, we can see that we will need to process 48 samples per
day (which, assuming an 80% sequencing success rate, means generating 39
high quality sequences per day) to ensure detection within the first
month of variant introduction into the population.</p>
</div>
<div class="section level5">
<h5 id="other-sampling-scenarios">Other sampling scenarios<a class="anchor" aria-label="anchor" href="#other-sampling-scenarios"></a>
</h5>
<p>For information on functions that can be used to estimate the sample
size given a cross-sectional sampling approach, see <em>Estimating the
sample size needed for variant monitoring:</em> <a href="V2_SampleSizeCrossSectional.html"><em>cross-sectional
sampling</em></a>. These functions can also be used in “reverse”, to
calculate the probability of detection given some sampling scheme, as in
the <em>Estimating the probability of detecting a variant</em> <a href="V3_ProbCrossSectional.html"><em>cross-sectional</em></a> and <a href="V5_ProbDetectPeriodic.html"><em>periodic</em></a> vignettes.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Shirlee Wohl, Elizabeth C Lee, Lucy D’Agostino McGowan, John R Giles, Justin Lessler.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
