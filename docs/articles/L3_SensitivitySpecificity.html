<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Estimating the sensitivity and specificity of a linkage criteria • phylosamp</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Estimating the sensitivity and specificity of a linkage criteria">
<meta property="og:description" content="phylosamp">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-173221313-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-173221313-2');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">phylosamp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Transmission Linkage</li>
    <li>
      <a href="../articles/L1_FalseDiscoveryRate.html">Estimating the linkage false discovery rate</a>
    </li>
    <li>
      <a href="../articles/L2_SampleSize.html">Sample size calculations for transmission linkage</a>
    </li>
    <li>
      <a href="../articles/L3_SensitivitySpecificity.html">Estimating sensitivity and specificity of a linkage criteria</a>
    </li>
    <li>
      <a href="../articles/L4_IllustrativeExamples.html">Illustrative Examples</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Variant Tracking</li>
    <li>
      <a href="../articles/V1_CoefficientDetectionBias.html">Estimating bias in observed variant prevalence</a>
    </li>
    <li>
      <a href="../articles/V2_SampleSizeCrossSectional.html">Sample size calculations for variant tracking (cross-sectional sampling)</a>
    </li>
    <li>
      <a href="../articles/V3_ProbCrossSectional.html">Probability of detection and prevalence estimation (cross-sectional sampling)</a>
    </li>
    <li>
      <a href="../articles/V4_SampleSizePeriodic.html">Sample size calculations for variant tracking (periodic sampling)</a>
    </li>
    <li>
      <a href="../articles/V5_ProbDetectPeriodic.html">Probability of detection (periodic sampling)</a>
    </li>
    <li>
      <a href="../articles/V6_IllustrativeExample.html">Variant Surveillance Example</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/HopkinsIDD/phylosamp/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Estimating the sensitivity and specificity of a
linkage criteria</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/HopkinsIDD/phylosamp/blob/HEAD/vignettes/L3_SensitivitySpecificity.Rmd" class="external-link"><code>vignettes/L3_SensitivitySpecificity.Rmd</code></a></small>
      <div class="hidden name"><code>L3_SensitivitySpecificity.Rmd</code></div>

    </div>

    
    
<p>The sensitivity and specificity of the linkage criteria to
distinguish between linked and unlinked infection pairs can be
determined by applying a specific linkage criteria to an existing
dataset for which the true transmission events are known, and then
extrapolating these results to a new or larger set of data for which
transmission are not known.</p>
<p>However, there are many scenarios in which this existing dataset is
not available or representative of the desired sampling population. In
this package, we provide a method for calculating the sensitivity and
specificity of genetic distance – the number of mutations between
pathogen genome sequences – as a linkage criteria. Further research is
needed to extend this method beyond genetic distance as the linkage
metric.</p>
<p>In this package, we provide a function
(<code><a href="../reference/gendist_sensspec_cutoff.html">gendist_sensspec_cutoff()</a></code>) to calculate the sensitivity
and specificity when using a specific genetic distance threshold (e.g. 2
mutations) or a vector of candidate thresholds (e.g. 1-10 mutations).
Note that samples separated by a genetic distance of less than the
cutoff are considered linked, so the minimum cutoff to consider is 1
(linked cases have identical genomes).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/HopkinsIDD/phylosamp" class="external-link">phylosamp</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gendist_sensspec_cutoff.html">gendist_sensspec_cutoff</a></span><span class="op">(</span>cutoff<span class="op">=</span><span class="fl">2</span>, </span>
<span>                        mut_rate<span class="op">=</span><span class="fl">1</span>, </span>
<span>                        mean_gens_pdf<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.02</span>,<span class="fl">0.08</span>,<span class="fl">0.15</span>,<span class="fl">0.75</span><span class="op">)</span>, </span>
<span>                        max_link_gens<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      cutoff sensitivity specificity</span></span>
<span><span class="co">## [1,]      2   0.7357589   0.8662894</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gendist_sensspec_cutoff.html">gendist_sensspec_cutoff</a></span><span class="op">(</span>cutoff<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, </span>
<span>                        mut_rate<span class="op">=</span><span class="fl">1</span>, </span>
<span>                        mean_gens_pdf<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.02</span>,<span class="fl">0.08</span>,<span class="fl">0.15</span>,<span class="fl">0.75</span><span class="op">)</span>, </span>
<span>                        max_link_gens<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##       cutoff sensitivity specificity</span></span>
<span><span class="co">##  [1,]      1   0.3678794 0.967314682</span></span>
<span><span class="co">##  [2,]      2   0.7357589 0.866289434</span></span>
<span><span class="co">##  [3,]      3   0.9196986 0.697765199</span></span>
<span><span class="co">##  [4,]      4   0.9810118 0.499227295</span></span>
<span><span class="co">##  [5,]      5   0.9963402 0.316627604</span></span>
<span><span class="co">##  [6,]      6   0.9994058 0.178637743</span></span>
<span><span class="co">##  [7,]      7   0.9999168 0.090198436</span></span>
<span><span class="co">##  [8,]      8   0.9999898 0.041044514</span></span>
<span><span class="co">##  [9,]      9   0.9999989 0.016951040</span></span>
<span><span class="co">## [10,]     10   0.9999999 0.006396198</span></span></code></pre>
<p>This method requires knowledge of the pathogen mutation rate, the
distribution of generations between cases, and the number of generations
between cases considered linked. We break down each of these inputs in
turn:</p>
<div class="section level5">
<h5 id="the-mutation-rate-of-the-pathogen">1. The mutation rate of the pathogen<a class="anchor" aria-label="anchor" href="#the-mutation-rate-of-the-pathogen"></a>
</h5>
<p>The mutation rate of the pathogen must be provided in mutations per
genome per generation, and represents the average number of mutations
observed between the genomes of an infector/infectee pair.</p>
<p>Many pathogen mutation rates are reported in substitutions per site
per year. We provide an example of converting the substitution rate for
Ebola virus (roughly <span class="math inline">\(1.2\times 10^{-3}
subs/site/year\)</span>) to mutations (used interchangeably with
substitutions for this purpose) per genome per generation:</p>
<p><span class="math display">\[ 1.2\times 10^{-3}\:subs/site/year
\:\times\:\frac{19000\text{ sites}}{1\text{ genome}}
\:\times\:\frac{1\text{ year}}{365\text{ days}}\:\times\:\frac{15\text{
days}}{1\text{ generation}}
= 0.94\:subs/genome/generation\]</span></p>
<p>In other words, assuming an approximate generation time of 15 days,
we would expect to see 1 mutation per generation of transmission.</p>
</div>
<div class="section level5">
<h5 id="the-distribution-of-generations-between-cases">2. The distribution of generations between cases<a class="anchor" aria-label="anchor" href="#the-distribution-of-generations-between-cases"></a>
</h5>
<p>The number of generations between all pairs of cases in the
population is key to determining how many of them are actually linked
(separated by less than <code>max_link_gens</code> generations of
transmission), which in turn is used to calculate the sensitivity and
specificity. This distribution is not trivial, but depends on the
reproductive number of the pathogen. We have simulated this distribution
for values of <span class="math inline">\(R\)</span> between 1.3 and 18
and averaged the results of 1000 simulations for each value. The results
are provided as part of this package at <code>data/genDistSim.Rda</code>
and can be used as a reasonable proxy for the generation distribution
for large outbreaks.</p>
<p>We provide an example of using these results for given the mutation
rate (~1) and reproductive number (1.5) of an Ebola-like virus:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">R</span> <span class="op">&lt;-</span> <span class="fl">1.5</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"genDistSim"</span><span class="op">)</span></span>
<span><span class="va">mgd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">genDistSim</span><span class="op">[</span><span class="va">genDistSim</span><span class="op">$</span><span class="va">R</span> <span class="op">==</span> <span class="va">R</span>, <span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/gendist_sensspec_cutoff.html">gendist_sensspec_cutoff</a></span><span class="op">(</span>cutoff<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, </span>
<span>                        mut_rate<span class="op">=</span><span class="fl">1</span>, </span>
<span>                        mean_gens_pdf<span class="op">=</span><span class="va">mgd</span>, </span>
<span>                        max_link_gens<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##       cutoff sensitivity specificity</span></span>
<span><span class="co">##  [1,]      1   0.3678794   0.9992910</span></span>
<span><span class="co">##  [2,]      2   0.7357589   0.9971700</span></span>
<span><span class="co">##  [3,]      3   0.9196986   0.9933593</span></span>
<span><span class="co">##  [4,]      4   0.9810118   0.9877469</span></span>
<span><span class="co">##  [5,]      5   0.9963402   0.9801562</span></span>
<span><span class="co">##  [6,]      6   0.9994058   0.9703223</span></span>
<span><span class="co">##  [7,]      7   0.9999168   0.9579376</span></span>
<span><span class="co">##  [8,]      8   0.9999898   0.9426909</span></span>
<span><span class="co">##  [9,]      9   0.9999989   0.9242939</span></span>
<span><span class="co">## [10,]     10   0.9999999   0.9025040</span></span></code></pre>
<p>We can then choose the optimal threshold and the associated
sensitivity and specificity for our transmission study. Many methods
exist for choosing the optimal threshold, including the Youden index,
closest to corner, etc. Using either of these methods, the optimal
threshold in this example is 5 mutations. In other words, cases separate
by less than 5 mutations will be considered linked given this linkage
criteria, which has a sensitivity of 98.1% and a specificity of
98.7%.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Shirlee Wohl, Elizabeth C Lee, Lucy D’Agostino McGowan, John R Giles, Justin Lessler.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
